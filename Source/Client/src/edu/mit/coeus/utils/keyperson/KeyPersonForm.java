/*
 * Copyright (c) Massachusetts Institute of Technology
 * 77 Massachusetts Avenue, Cambridge, MA 02139-4307
 * All rights reserved.
 */

package edu.mit.coeus.utils.keyperson;

// JM 6-14-2012 added for VU customizations
import java.awt.Dimension;
import java.awt.event.MouseEvent;

import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.table.JTableHeader;

import edu.vanderbilt.coeus.gui.CoeusHelpGidget;
import edu.vanderbilt.coeus.gui.CoeusToolTip;
import edu.vanderbilt.coeus.utils.CustomFunctions;
// JM END
import edu.mit.coeus.gui.CoeusFontFactory;


/**
 * KeyPersonForm.java
 *
 * @author Sreenath
 */
public class KeyPersonForm extends javax.swing.JComponent {
    
	// JM 6-14-2012 static variables for setting pane dimensions;
	// PERSON_PANE:  resized width from 350, height from 200
	// UNIT_PANE:  resized width from 350, height from 140
	// MAIN_PANE:  resized width from 850, height from 980
	private static final int PERSON_PANE_WIDTH = 730;
	private static final int PERSON_PANE_HEIGHT = 260;
	private static final int UNIT_PANE_WIDTH = 730;
	private static final int UNIT_PANE_HEIGHT = 140;
	private static final int MAIN_PANE_WIDTH = 1050;
	private static final int MAIN_PANE_HEIGHT = 780;
	// JM END
	
	// JM 11-14-2012 custom button labels; 1-27-2016 changed declaration to non-static for Find Employee
	private static final String FIND_NON_EMPLOYEE = "Find Non-Employee";
	public String FIND_EMPLOYEE = "Find VU Employee";
	private static final int BUTTON_WIDTH = 184; // was 106
	// JM END
	
	// JM 1-26-2016 dynamic Find Employee button label
	private String acronym, sister;
	// JM END  
    
    public KeyPersonForm() {
        initComponents();
    }
    public javax.swing.JTable getInvestigatorTableInstance(){
        return tblInvestigator;
    }

    public javax.swing.JTable getUnitTableInstance(){
        return tblUnits;
    }
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
       
        java.awt.GridBagConstraints gridBagConstraints;

        pnlButtonsContainer = new javax.swing.JPanel();
        btnAdd = new javax.swing.JButton();
        btnDelete = new javax.swing.JButton();
        btnFindPerson = new javax.swing.JButton();
        btnFindRolodex = new javax.swing.JButton();
        pnlAddUnitButton = new javax.swing.JPanel();
        btnAddUnit = new javax.swing.JButton();
        btnDeleteUnit = new javax.swing.JButton();
        btnFindUnit = new javax.swing.JButton();
        jcrPnInvestigator = new javax.swing.JScrollPane();
        
	    // JM 6-14-2012 add tool tips to column headers
	  	final String[] columnToolTips = {
	  			null,
	  			CoeusToolTip.getToolTip("personName_toolTip.1004"),
	  			CoeusToolTip.getToolTip("role_toolTip.1004"),
	  			CoeusToolTip.getToolTip("facultyFlag_toolTip.1004"),
	  			CoeusToolTip.getToolTip("effortPct_toolTip.1004"),
	  			CoeusToolTip.getToolTip("academicEffortPct_toolTip.1004"),
	  			CoeusToolTip.getToolTip("summerEffortPct_toolTip.1004"),
	  			CoeusToolTip.getToolTip("calendarEffortPct_toolTip.1004"),
	  			null, null
	  	};
        // JM END
        
        tblInvestigator = new javax.swing.JTable(){
        	// JM 6-14-2012 implement table header tool tips.
	        protected JTableHeader createDefaultTableHeader() {
	            return new JTableHeader(columnModel) {
	                public String getToolTipText(MouseEvent e) {
	                    java.awt.Point p = e.getPoint();
	                    int index = columnModel.getColumnIndexAtX(p.x);
	                    int realIndex = columnModel.getColumn(index).getModelIndex();
	                    return columnToolTips[realIndex];
	                }
	            };
	        }
	        // JM END
            public void changeSelection(int row, int column, boolean toggle, boolean extend){
                super.changeSelection(row, column, toggle, extend);
                //Added for case id 2229 - start
                if(tblInvestigator.isCellEditable(row,column)){
                    tblInvestigator.editCellAt(row, column);
                }
                //Added for case id 2229 - end
                //Commented for case id 2229 - start
                //                javax.swing.SwingUtilities.invokeLater( new Runnable() {
                    //                    public void run() {
                        //                        getInvestigatorTableInstance().dispatchEvent(new java.awt.event.KeyEvent(
                            //                            getInvestigatorTableInstance() ,java.awt.event.KeyEvent.KEY_PRESSED,0,0,java.awt.event.KeyEvent.VK_F2,
                            //                            java.awt.event.KeyEvent.CHAR_UNDEFINED) );
                    //                    }
                //                });
        //Commented for case id 2229 - end
    }
    };
    // JM 6-14-2012 updated font; updated header height to be prettier
    tblInvestigator.setFont(CoeusFontFactory.getNormalFont());
    tblInvestigator.getTableHeader().setPreferredSize(new Dimension(tblInvestigator.getTableHeader().getWidth(),35));
    // JM END
	    
    jcrPnUnits = new javax.swing.JScrollPane();
    tblUnits = new javax.swing.JTable(){
        public void changeSelection(int row, int column, boolean toggle, boolean extend){
            super.changeSelection(row, column, toggle, extend);
            //Added for case id 2229 - start
            if(tblUnits.isCellEditable(row, column)){
                tblUnits.editCellAt(row, column);
            }
            //Added for case id 2229 - end
            //Commented for case id 2229 - start
            //                javax.swing.SwingUtilities.invokeLater( new Runnable() {
                //                    public void run() {
                    //                        getUnitTableInstance().dispatchEvent(new java.awt.event.KeyEvent(
                        //                            getUnitTableInstance() ,java.awt.event.KeyEvent.KEY_PRESSED,0,0,java.awt.event.KeyEvent.VK_F2,
                        //                            java.awt.event.KeyEvent.CHAR_UNDEFINED) );
                //                    }
            //                });
    //Commented for case id 2229 - end
    }
    };
    // JM 6-14-2012 updated font; updated header height to be prettier
    tblUnits.setFont(CoeusFontFactory.getNormalFont());
    tblUnits.getTableHeader().setPreferredSize(new Dimension(tblUnits.getTableHeader().getWidth(),35));
    // JM END

    // JM 6-9-2011 resized with static variable to accommodate new percent effort fields
    setMaximumSize(new java.awt.Dimension(MAIN_PANE_WIDTH, MAIN_PANE_HEIGHT));
    setMinimumSize(new java.awt.Dimension(MAIN_PANE_WIDTH, MAIN_PANE_HEIGHT));
    setPreferredSize(new java.awt.Dimension(MAIN_PANE_WIDTH, MAIN_PANE_HEIGHT));
    // JM END
    setRequestFocusEnabled(false);
    setLayout(new java.awt.GridBagLayout());

    // JM 11-14-2012 resized for longer labels
    //pnlButtonsContainer.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 140));
    //pnlButtonsContainer.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 140));
    //pnlButtonsContainer.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 140));
    // JM END
    pnlButtonsContainer.setLayout(new java.awt.GridBagLayout());

    btnAdd.setFont(CoeusFontFactory.getLabelFont());
    btnAdd.setMnemonic('A');
    btnAdd.setText("Add");
    // JM 11-14-2012 resized for longer labels
    btnAdd.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnAdd.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnAdd.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    // JM END
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlButtonsContainer.add(btnAdd, gridBagConstraints);

    btnDelete.setFont(CoeusFontFactory.getLabelFont());
    btnDelete.setMnemonic('D');
    btnDelete.setText("Delete");
    // JM 11-14-2012 resized for longer labels
    btnDelete.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnDelete.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnDelete.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    // JM END
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 1;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlButtonsContainer.add(btnDelete, gridBagConstraints);

    btnFindPerson.setFont(CoeusFontFactory.getLabelFont());
    btnFindPerson.setMnemonic('P');
    // JM 11-14-2012 updated button label; resized for longer labels
    //btnFindPerson.setText("Find Person");
    btnFindPerson.setText(FIND_EMPLOYEE);
    btnFindPerson.setToolTipText(CoeusToolTip.getToolTip("personBtn_toolTip.1000"));
    btnFindPerson.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnFindPerson.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnFindPerson.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    // JM END
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 2;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlButtonsContainer.add(btnFindPerson, gridBagConstraints);

    btnFindRolodex.setFont(CoeusFontFactory.getLabelFont());
    btnFindRolodex.setMnemonic('R');
    btnFindRolodex.setText("Find Rolodex");
    // JM 11-14-2012 updated button label
    //btnFindRolodex.setText("Find Rolodex");
    btnFindRolodex.setText(FIND_NON_EMPLOYEE);
    btnFindRolodex.setToolTipText(CoeusToolTip.getToolTip("rolodexBtn_toolTip.1000"));
    btnFindRolodex.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnFindRolodex.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnFindRolodex.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    // JM END
    btnFindRolodex.setRequestFocusEnabled(false);
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 3;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlButtonsContainer.add(btnFindRolodex, gridBagConstraints);

    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 6;
    gridBagConstraints.gridy = 0;
    gridBagConstraints.gridwidth = java.awt.GridBagConstraints.RELATIVE;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
	// JM 6-19-2012 updated top inset from 16 to 3 so buttons would sit at top
	gridBagConstraints.insets = new java.awt.Insets(3, 5, 1, 2);
	// JM END
    add(pnlButtonsContainer, gridBagConstraints);

    pnlAddUnitButton.setPreferredSize(new java.awt.Dimension(106, 165));
    pnlAddUnitButton.setLayout(new java.awt.GridBagLayout());

    btnAddUnit.setFont(CoeusFontFactory.getLabelFont());
    btnAddUnit.setMnemonic('n');
    btnAddUnit.setText("Add Unit");
    btnAddUnit.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnAddUnit.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnAddUnit.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlAddUnitButton.add(btnAddUnit, gridBagConstraints);

    btnDeleteUnit.setFont(CoeusFontFactory.getLabelFont());
    btnDeleteUnit.setMnemonic('l');
    btnDeleteUnit.setText("Delete Unit");
    btnDeleteUnit.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnDeleteUnit.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnDeleteUnit.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 1;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlAddUnitButton.add(btnDeleteUnit, gridBagConstraints);

    btnFindUnit.setFont(CoeusFontFactory.getLabelFont());
    btnFindUnit.setMnemonic('u');
    btnFindUnit.setText("Find Unit");
    btnFindUnit.setMaximumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnFindUnit.setMinimumSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    btnFindUnit.setPreferredSize(new java.awt.Dimension(BUTTON_WIDTH, 26));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 2;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 0);
    pnlAddUnitButton.add(btnFindUnit, gridBagConstraints);

    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 6;
    gridBagConstraints.gridy = 7;
    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
    gridBagConstraints.insets = new java.awt.Insets(8, 5, 2, 2);
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST; // JM
    add(pnlAddUnitButton, gridBagConstraints);

    jcrPnInvestigator.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    // JM 6-13-2012 resized dimensions to accommodate new percent effort fields  
    jcrPnInvestigator.setMaximumSize(new java.awt.Dimension(PERSON_PANE_WIDTH, PERSON_PANE_HEIGHT));
    jcrPnInvestigator.setMinimumSize(new java.awt.Dimension(PERSON_PANE_WIDTH, PERSON_PANE_HEIGHT));
    jcrPnInvestigator.setPreferredSize(new java.awt.Dimension(PERSON_PANE_WIDTH, PERSON_PANE_HEIGHT));
    // JM END

    tblInvestigator.setModel(new javax.swing.table.DefaultTableModel(
        new Object [][] {
            {},
            {},
            {},
            {}
        },
        new String [] {

        }
    ));
    tblInvestigator.addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseClicked(java.awt.event.MouseEvent evt) {
            tblInvestigatorMouseClicked(evt);
        }
    });
    jcrPnInvestigator.setViewportView(tblInvestigator);

    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 0;
    gridBagConstraints.gridwidth = 6;
    gridBagConstraints.gridheight = 7;
    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.weightx = 1.0;
    // JM 6-18-2012 changed insets to be prettier
    //gridBagConstraints.insets = new java.awt.Insets(24, 5, 1, 0);
    gridBagConstraints.insets = new java.awt.Insets(0, 3, 1, 5);
    // JM END
    add(jcrPnInvestigator, gridBagConstraints);

    jcrPnUnits.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    // JM 6-13-2012 resized dimensions to match new dimensions in person pane  
    jcrPnUnits.setMaximumSize(new java.awt.Dimension(UNIT_PANE_WIDTH, UNIT_PANE_HEIGHT));
    jcrPnUnits.setMinimumSize(new java.awt.Dimension(UNIT_PANE_WIDTH, UNIT_PANE_HEIGHT));
    jcrPnUnits.setPreferredSize(new java.awt.Dimension(UNIT_PANE_WIDTH, UNIT_PANE_HEIGHT));
    // JM END

    tblUnits.setModel(new javax.swing.table.DefaultTableModel(
        new Object [][] {
            {},
            {},
            {},
            {}
        },
        new String [] {

        }
    ));
    tblUnits.addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseClicked(java.awt.event.MouseEvent evt) {
            tblUnitsMouseClicked(evt);
        }
    });
    jcrPnUnits.setViewportView(tblUnits);

    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 7;
    gridBagConstraints.gridwidth = 6;
    gridBagConstraints.gridheight = 3;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.weightx = 1.0;
    // JM 6-14-2012 updated to match person table
    //gridBagConstraints.insets = new java.awt.Insets(7, 5, 27, 0);
    gridBagConstraints.insets = new java.awt.Insets(7, 3, 27, 5);
    // JM END
    add(jcrPnUnits, gridBagConstraints);
	    
// JM 6-14-2012 panel for page usage directions
    CoeusHelpGidget gidgetUsage = new CoeusHelpGidget("effortCalc_helpCode.1004");
    JScrollPane scrPnUsage = new JScrollPane(gidgetUsage.createHelpScrollArea());
    scrPnUsage.setMaximumSize(new java.awt.Dimension(830, 250));
    scrPnUsage.setMinimumSize(new java.awt.Dimension(830, 250));
    scrPnUsage.setPreferredSize(new java.awt.Dimension(830, 250));

    JPanel pnlUsage = gidgetUsage.createHelpPanel();
    //pnlUsage.setPreferredSize(new java.awt.Dimension(890,250));
    pnlUsage.add(scrPnUsage, java.awt.BorderLayout.CENTER);
     
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 20;
    gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTH;
    gridBagConstraints.insets = new java.awt.Insets(50, 2, 2, 2);
    add(pnlUsage, gridBagConstraints);
//END
	    
	    
    }// </editor-fold>//GEN-END:initComponents

    private void tblInvestigatorMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblInvestigatorMouseClicked
        //Commented for case id 2229 - start
        //         javax.swing.SwingUtilities.invokeLater( new Runnable() {
        //            public void run() {
        //                getUnitTableInstance().dispatchEvent(new java.awt.event.KeyEvent(
        //                getUnitTableInstance(),java.awt.event.KeyEvent.KEY_PRESSED,0,0,java.awt.event.KeyEvent.VK_F2,
        //                java.awt.event.KeyEvent.CHAR_UNDEFINED) );
        //            }
        //        });
        //Commented for case id 2229 - end
    }//GEN-LAST:event_tblInvestigatorMouseClicked

    private void tblUnitsMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblUnitsMouseClicked
        //Commented for case id 2229 - start
        //        javax.swing.SwingUtilities.invokeLater( new Runnable() {
        //            public void run() {
        //                getInvestigatorTableInstance().dispatchEvent(new java.awt.event.KeyEvent(
        //                getInvestigatorTableInstance(),java.awt.event.KeyEvent.KEY_PRESSED,0,0,java.awt.event.KeyEvent.VK_F2,
        //                java.awt.event.KeyEvent.CHAR_UNDEFINED) );
        //            }
        //        });
        //Commented for case id 2229 - end
}//GEN-LAST:event_tblUnitsMouseClicked
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    public javax.swing.JButton btnAdd;
    public javax.swing.JButton btnAddUnit;
    public javax.swing.JButton btnDelete;
    public javax.swing.JButton btnDeleteUnit;
    public javax.swing.JButton btnFindPerson;
    public javax.swing.JButton btnFindRolodex;
    public javax.swing.JButton btnFindUnit;
    public javax.swing.JScrollPane jcrPnInvestigator;
    public javax.swing.JScrollPane jcrPnUnits;
    public javax.swing.JPanel pnlAddUnitButton;
    public javax.swing.JPanel pnlButtonsContainer;
    public javax.swing.JTable tblInvestigator;
    public javax.swing.JTable tblUnits;
    // End of variables declaration//GEN-END:variables
       
}

